<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phone Screen: Homepage</title>

    <link href="/css/palette.css" rel="stylesheet" type="text/css" media="all">
    <link href="css/phoneGlobals.css" rel="stylesheet" type="text/css" media="all">

    <link href="css/homepageBase.css" rel="stylesheet" type="text/css" media="all">

    <link id="homepageCSS" href="css/homepageThemes/homepageLight.css" rel="stylesheet" type="text/css" media="all"
        data-theme="light">

    <link id="homepageDarkCSS" href="css/homepageThemes/homepageDark.css" rel="stylesheet" type="text/css" media="all"
        data-theme="dark">
    <link id="homepageChristmasCSS" href="css/homepageThemes/homepageChristmas.css" rel="stylesheet" type="text/css"
        media="all" data-theme="christmas">


    <meta name="description" content="Access literally everything you need." />
    <link rel="icon" type="image/x-icon" href="../Assets/pixels/vintageAmericana/strawberryphone.webp">

    <script src="https://code.iconify.design/iconify-icon/2.1.0/iconify-icon.min.js"></script>

    <script src="js/phone.js"></script>
    <script src="js/stats.js"></script>
</head>

<body>
    <object id="detailBarObject" data="detailbar.html"></object>

    <div id="homepages">
        <div class="homepage active" id="homepage1">
            <div class="appWrapper">
                <div style="display: flex; margin: 0 auto; column-gap: 25px;">
                    <div class="column2">
                        <img class="widget" src="/Assets/kpop/IVE/selcas/wonyoungChristmas2.jpg">
                        <p>widgetsmith</p>
                    </div>

                    <div class="column1">
                        <a href="nav.html" class="app" onclick="openApp(event, this)">
                            <div class="appIcon">
                                <img src="/Assets/customNavIcons/navIcon.png">
                            </div>
                            <p>Navigation</p>
                        </a>
                        <a href="idolMessenger.html" class="app" onclick="openApp(event, this)">
                            <div id="idolMessenger" class="appIcon">
                                <img src="/Assets/customNavIcons/idolMessengerIcon.png">
                            </div>
                            <p>Idol Messenger</p>
                        </a>
                    </div>
                </div>

                <a href="socials.html" class="app" onclick="openApp(event, this)">
                    <div id="asterism" class="appIcon">
                        <img src="/Assets/customNavIcons/asterismIcon.png">
                    </div>
                    <p>Asterism</p>
                </a>

                <a href="stats.html" class="app" onclick="openApp(event, this)">
                    <div class="appIcon">
                        <img src="/Assets/customNavIcons/statsIcon.png">
                    </div>
                    <p>Stats</p>
                </a>
                <a href="idolFinder.html" class="app" onclick="openApp(event, this)">
                    <div id="idolFinder" class="appIcon">
                        <img src="/Assets/customNavIcons/peersIcon.png">
                    </div>
                    <p>IdolFinder</p>
                </a>
                <a href="gallery.html" class="app" onclick="openApp(event, this)">
                    <div class="appIcon">
                        <img src="/Assets/customNavIcons/galleryIcon.png">
                    </div>
                    <p>Gallery</p>
                </a>
                <a href="themes.html" class="app" onclick="openApp(event, this)">
                    <div class="appIcon">
                        <img src="/Assets/customNavIcons/shiny_cats_pact_by_yuriachanartist.png">
                    </div>
                    <p>Themes</p>
                </a>
                <a href="music.html" class="app" onclick="openApp(event, this)">
                    <div id="serenade" class="appIcon">
                        <img src="/Assets/customNavIcons/serenadeIcon.png">
                    </div>
                    <p>Serenade</p>
                </a>
            </div>
        </div>

        <div class="homepage" id="homepage2">
            <div class="appWrapper">
                <div id="weatherWidget">
                    <div id="wwTop">
                        <p id="wwCityName">Yomiyama City</p>

                        <!-- ! Modify per season: Here, Detail Bar, homepageBase, phone.js -->
                        <p id="wwTemp">20Â°F</p>
                        <div id="wwWeatherIcon" class="weatherIcon">
                            <iconify-icon icon="ion:cloudy"></iconify-icon>
                        </div>
                    </div>
                    <div id="wwBottom">
                        <div id="forecastContainer" class="weeklyForecast"></div>
                    </div>
                </div>

                <a href="idolPet.html" class="app" onclick="openApp(event, this)">
                    <div id="idolPet" class="appIcon">
                        <img src="/Assets/customNavIcons/IdolPetIcon.png">
                    </div>
                    <p>IdolPet</p>
                </a>
                <a href="temp.html" class="app UNF" onclick="openApp(event, this)">
                    <div class="appIcon"></div>
                    <p>Mellow</p>
                </a>

                <a href="temp.html" class="app UNF" onclick="openApp(event, this)">
                    <div class="appIcon"></div>
                    <p>Treasure Island</p>
                </a>
                <a href="temp.html" class="app UNF" onclick="openApp(event, this)">
                    <div class="appIcon"></div>
                    <p>Your Tome</p>
                </a>
                <a href="temp.html" class="app UNF" onclick="openApp(event, this)">
                    <div class="appIcon"></div>
                    <p>Stellar Shop</p>
                </a>
            </div>
        </div>
        <footer>
            <div class="swipeIcons">
                <iconify-icon icon="material-symbols:circle" class="navDots" onclick="showHomepage(0)"></iconify-icon>
                <iconify-icon icon="material-symbols:circle" class="navDots" onclick="showHomepage(1)"></iconify-icon>
            </div>

            <tray>
                <a href="temp.html" class="app UNF" onclick="openApp(event, this)">
                    <div class="appIcon">
                        <img src="/Assets/customNavIcons/shiranaiIcon.png">
                    </div>
                    <p>SHIRANAI</p>
                </a>
                <a href="settings.html" class="app" onclick="openApp(event, this)">
                    <div class="appIcon">
                        <img src="/Assets/customNavIcons/settingsIcon.png">
                    </div>
                    <p>Settings</p>
                </a>
                <a href="temp.html" class="app UNF" onclick="openApp(event, this)">
                    <div class="appIcon">
                        <img src="/Assets/customNavIcons/cameraIcon.png">
                    </div>
                    <p>Camera</p>
                </a>
            </tray>
        </footer>
    </div>

    <script>
        function openApp(event, appElement) {
            event.preventDefault();

            if (appElement.classList.contains('open')) return;

            appElement.classList.add('open');

            const appHref = appElement.getAttribute('href');

            incrementAppOpenedCount();

            setTimeout(() => {
                parent.document.getElementById('phoneScreen').src = appHref;
            }, 350);
        }


        let currentHomepage = parseInt(localStorage.getItem('currentHomepage')) || 0;
        const homepages = document.querySelectorAll('.homepage');
        const navDots = document.querySelectorAll('.navDots');  // Select all dots

        function showHomepage(index, autoOpenFirstApp = false) {
            homepages.forEach((homepage, i) => {
                if (i === index) {
                    homepage.classList.remove('hidden');
                    homepage.classList.add('active');
                } else {
                    homepage.classList.add('hidden');
                    homepage.classList.remove('active');
                }
            });

            navDots.forEach((dot, i) => {
                if (i === index) {
                    dot.classList.add('active');
                    dot.classList.remove('inactive');
                } else {
                    dot.classList.add('inactive');
                    dot.classList.remove('active');
                }
            });

            localStorage.setItem('currentHomepage', index);
        }

        document.addEventListener('swiped-right', () => {
            currentHomepage = (currentHomepage > 0) ? currentHomepage - 1 : homepages.length - 1;
            showHomepage(currentHomepage);
        });

        document.addEventListener('swiped-left', () => {
            currentHomepage = (currentHomepage < homepages.length - 1) ? currentHomepage + 1 : 0;
            showHomepage(currentHomepage);
        });

        navDots.forEach((dot, i) => {
            if (i === currentHomepage) {
                dot.classList.add('active');
                dot.classList.remove('inactive');
            } else {
                dot.classList.add('inactive');
                dot.classList.remove('active');
            }
        });

        showHomepage(currentHomepage); 
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const themeLinks = Array.from(document.querySelectorAll("link[id^='homepage']"));
            const savedTheme = localStorage.getItem("globalTheme") || "light";
            const pageName = window.location.pathname.split('/').pop().split('.')[0];

            const forceChristmasTheme = localStorage.getItem("forceChristmasTheme") || "true";
            const availableThemes = themeLinks.map(link => link.id.replace(pageName, '').replace('CSS', '').toLowerCase());

            let validTheme;

            if (forceChristmasTheme === "true") {
                validTheme = "christmas";
            } else {
                validTheme = (availableThemes.includes(savedTheme) && themeLinks.some(link => link.getAttribute("data-theme") === savedTheme))
                    ? savedTheme
                    : "light";
            }

            themeLinks.forEach(link => {
                link.disabled = link.getAttribute("data-theme") !== validTheme;
            });
        });
    </script>

</body>

</html>